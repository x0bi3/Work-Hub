<!DOCTYPE html>
<!-- Work-Hub Portal v2.1 - Newsletter subscription added -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Work Hub - Employee Portal">
    <!-- Prevent browser caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Work Hub Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Walmart Blue Theme */
            --primary: #0071dc;
            --primary-light: #1a8cff;
            --primary-dark: #004c91;
            --secondary: #041f41;
            --accent: #ffc220;
            --success: #10b981;
            --danger: #ef4444;
            --light: #f0f7ff;
            --text: #1a1a1a;
            --text-light: #666;
            --border: #e0e0e0;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
            /* Walmart Spark Yellow for highlights */
            --spark: #ffc220;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: #fafafa;
        }

        header {
            background: var(--primary);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        header p {
            opacity: 0.95;
            font-size: 1rem;
        }

        /* Main Navigation */
        .main-nav {
            background: var(--primary-dark);
            display: flex;
            overflow-x: auto;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-tab {
            flex: 1;
            min-width: 200px;
            padding: 1rem;
            border: none;
            background: transparent;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .nav-tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-tab.active {
            background: var(--primary);
            border-bottom-color: var(--accent);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Page Sections */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 2rem;
        }

        h3 {
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* FAQ Page */
        .faq-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .category-dropdown {
            margin-bottom: 2rem;
        }

        .category-dropdown select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            background: white;
            color: var(--text);
        }

        .category-dropdown select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.1);
        }

        .faq-item {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .faq-question {
            padding: 1.5rem;
            background: var(--light);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .faq-question:hover {
            background: var(--primary);
            color: white;
        }

        .faq-toggle {
            font-size: 1.5rem;
            transition: transform 0.3s;
        }

        .faq-toggle.open {
            transform: rotate(180deg);
        }

        .faq-answer {
            padding: 1.5rem;
            display: none;
            background: white;
            border-top: 2px solid var(--light);
            color: var(--text-light);
            line-height: 1.8;
        }

        .faq-answer.open {
            display: block;
        }

        /* Rich Content Styling (for FAQ answers and TMYK content) */
        .rich-content {
            line-height: 1.8;
        }

        .rich-content h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin: 1rem 0 0.5rem 0;
            color: var(--primary-dark);
        }

        .rich-content h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0.875rem 0 0.5rem 0;
            color: var(--primary-dark);
        }

        .rich-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0.75rem 0 0.5rem 0;
            color: var(--primary-dark);
        }

        .rich-content h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0.5rem 0 0.25rem 0;
            color: var(--primary-dark);
        }

        .rich-content p {
            margin: 0.5rem 0;
        }

        .rich-content ul, .rich-content ol {
            margin: 0.5rem 0 0.5rem 1.5rem;
            padding-left: 0.5rem;
        }

        .rich-content li {
            margin-bottom: 0.25rem;
        }

        .rich-content a {
            color: var(--primary);
            text-decoration: underline;
            transition: color 0.2s;
        }

        .rich-content a:hover {
            color: var(--primary-dark);
        }

        .rich-content img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .rich-content strong, .rich-content b {
            font-weight: 700;
        }

        .rich-content em, .rich-content i {
            font-style: italic;
        }

        .rich-content u {
            text-decoration: underline;
        }

        .rich-content s, .rich-content strike {
            text-decoration: line-through;
        }

        .rich-content blockquote {
            border-left: 4px solid var(--primary);
            padding-left: 1rem;
            margin: 1rem 0;
            font-style: italic;
            color: var(--text-light);
            background: var(--light);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
        }

        .rich-content code {
            background: #f4f4f4;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        .rich-content pre {
            background: #f4f4f4;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            margin: 1rem 0;
        }

        .rich-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .rich-content th, .rich-content td {
            border: 1px solid var(--border);
            padding: 0.75rem;
            text-align: left;
        }

        .rich-content th {
            background: var(--light);
            font-weight: 600;
        }

        /* Carousel Section - Walmart Blue Theme */
        .carousel-section {
            margin-bottom: 3rem;
        }

        .carousel-container {
            position: relative;
            background: linear-gradient(180deg, var(--primary-dark) 0%, var(--primary) 50%, var(--primary-light) 100%);
            border-radius: 16px;
            padding: 2.5rem 2rem 2rem;
            box-shadow: var(--shadow-lg);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        /* Walmart Spark decoration */
        .carousel-container::before {
            content: '‚ú¶';
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 2rem;
            color: var(--spark);
            opacity: 0.6;
        }

        .carousel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }

        .carousel-title {
            color: white;
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .carousel-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .carousel-nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.4);
            background: rgba(255,255,255,0.15);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carousel-nav-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: white;
            transform: scale(1.1);
        }

        .carousel-nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .autoplay-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.4);
            border-radius: 20px;
            padding: 6px 14px;
            color: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .autoplay-toggle:hover {
            background: rgba(255,255,255,0.25);
            border-color: white;
        }

        .autoplay-toggle.playing {
            background: var(--spark);
            border-color: var(--spark);
            color: var(--primary-dark);
        }

        .carousel-track-wrapper {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
            will-change: transform;
        }

        .carousel-slide {
            flex: 0 0 100%;
            min-height: 280px;
            background: white;
            border-radius: 12px;
            padding: 2rem;
            color: var(--text);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .carousel-slide:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .carousel-slide-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .carousel-slide h4 {
            font-size: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--primary-dark);
        }

        .carousel-slide p {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            flex-grow: 1;
            font-size: 1rem;
            line-height: 1.7;
        }

        .carousel-btn {
            align-self: flex-start;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .carousel-btn:hover {
            background: var(--primary-dark);
            transform: translateX(4px);
        }

        .carousel-btn::after {
            content: '‚Üí';
            transition: transform 0.3s;
        }

        .carousel-btn:hover::after {
            transform: translateX(4px);
        }

        /* Carousel Indicators (Dots) */
        .carousel-indicators {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .carousel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.4);
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            padding: 0;
        }

        .carousel-dot:hover {
            background: rgba(255,255,255,0.7);
            transform: scale(1.2);
        }

        .carousel-dot.active {
            background: var(--spark);
            transform: scale(1.3);
            box-shadow: 0 0 10px rgba(255,194,32,0.5);
        }

        /* Progress bar for auto-scroll */
        .carousel-progress {
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .carousel-progress-bar {
            height: 100%;
            background: var(--spark);
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s linear;
        }

        .carousel-progress-bar.paused {
            animation: none !important;
        }

        /* Content Section */
        .carousel-content {
            background: white;
            border-radius: 12px;
            padding: 2.5rem;
            border: none;
            box-shadow: var(--shadow-lg);
            border-left: 5px solid var(--primary);
            position: relative;
        }

        .carousel-content h4 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-size: 1.5rem;
            padding-right: 2rem;
        }

        .carousel-content p {
            color: var(--text);
            line-height: 1.9;
            font-size: 1.05rem;
        }

        .carousel-content ul, .carousel-content ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
            color: var(--text);
        }

        .carousel-content li {
            margin-bottom: 0.5rem;
            line-height: 1.7;
        }

        /* Calendar Section */
        .calendar-wrapper {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .calendar {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .calendar-header button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
        }

        .calendar-header h3 {
            margin: 0;
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .weekday {
            text-align: center;
            font-weight: 700;
            color: var(--primary);
            padding: 0.5rem 0;
        }

        .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .day {
            aspect-ratio: 1;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 0.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .day:hover {
            background: var(--light);
            border-color: var(--primary);
        }

        .day.has-event {
            background: var(--light);
            border-color: var(--primary);
            font-weight: 600;
            color: var(--primary);
        }

        .day.has-event::after {
            content: '\25cf';
            position: absolute;
            bottom: 2px;
            right: 5px;
            color: var(--accent);
            font-size: 1rem;
        }

        .day.other-month {
            color: var(--border);
            cursor: default;
        }

        .day.other-month:hover {
            background: transparent;
            border-color: var(--border);
        }

        .day.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary-dark);
        }

        .day.selected.has-event::after {
            color: white;
        }

        /* Events List */
        .events-list {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .events-list h3 {
            margin-top: 0;
        }

        .event-item {
            padding: 1rem;
            border-left: 4px solid var(--primary);
            margin-bottom: 1rem;
            background: var(--light);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .event-item:hover,
        .event-item.active {
            background: var(--primary);
            color: white;
            border-left-color: var(--accent);
            transform: translateX(4px);
        }

        .event-item h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
        }

        .event-item p {
            margin: 0.25rem 0;
            font-size: 0.85rem;
            opacity: 0.8;
        }

        /* Newsletter Section */
        .newsletter-wrapper {
            max-width: 900px;
        }

        .newsletter-list {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .newsletter-item {
            padding: 1.5rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .newsletter-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
            transform: translateY(-2px);
        }

        .newsletter-item h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .newsletter-item .date {
            color: var(--text-light);
            font-size: 0.85rem;
        }



        /* Responsive */
        @media (max-width: 1024px) {
            .calendar-wrapper {
                grid-template-columns: 1fr;
            }

            .events-list {
                position: static;
            }


        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            .nav-tab {
                padding: 0.75rem 0.5rem;
                font-size: 0.9rem;
                min-width: 150px;
            }

            .container {
                padding: 1rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            /* Carousel Mobile Styles */
            .carousel-container {
                padding: 1.5rem 1rem 1.5rem;
                border-radius: 12px;
            }

            .carousel-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .carousel-controls {
                width: 100%;
                justify-content: center;
            }

            .carousel-nav-btn {
                width: 36px;
                height: 36px;
                font-size: 1rem;
            }

            .autoplay-toggle {
                padding: 5px 12px;
                font-size: 0.8rem;
            }

            .carousel-slide {
                min-height: 220px;
                padding: 1.5rem;
            }

            .carousel-slide-icon {
                font-size: 2.5rem;
            }

            .carousel-slide h4 {
                font-size: 1.25rem;
            }

            .carousel-slide p {
                font-size: 0.9rem;
            }

            .carousel-btn {
                padding: 10px 18px;
                font-size: 0.9rem;
            }

            .carousel-content {
                padding: 1.5rem;
            }

            .carousel-content h4 {
                font-size: 1.25rem;
            }

            .carousel-content p {
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
    <header style="position: relative;">
        <h1>üìö Work Hub Portal</h1>
        <p>Your Employee Resource Center</p>
        <!-- VOTA Button -->
        <button onclick="openVotaModal()" 
                style="position: absolute; top: 1.5rem; right: 1.5rem; padding: 10px 20px; background: linear-gradient(135deg, #BF5B04, #457373); color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 0.95rem; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); transition: all 0.3s;" 
                onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.25)';"
                onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.2)';">
            üó≥Ô∏è VOTA
        </button>
    </header>

    <!-- VOTA Modal -->
    <div id="vota-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 12px; padding: 2rem; max-width: 450px; width: 90%; box-shadow: 0 20px 40px rgba(0,0,0,0.3); position: relative;">
            <button onclick="closeVotaModal()" style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666;" aria-label="Close modal">&times;</button>
            <h3 style="color: #BF5B04; margin-bottom: 1.5rem; font-size: 1.4rem;">üó≥Ô∏è VOTA Submission</h3>
            <form id="vota-form" onsubmit="submitVota(event)">
                <div style="margin-bottom: 1.25rem;">
                    <label for="vota-associate-id" style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #333;">Associate ID</label>
                    <input type="text" 
                           id="vota-associate-id" 
                           placeholder="Enter 1-5 digit ID" 
                           pattern="[0-9]{1,5}" 
                           maxlength="5" 
                           required 
                           style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 1rem; transition: border-color 0.3s;"
                           onfocus="this.style.borderColor='#457373';"
                           onblur="this.style.borderColor='#ddd';">
                    <small style="color: #666; font-size: 0.85rem;">Numbers only, 1-5 digits</small>
                </div>
                <div style="margin-bottom: 1.5rem;">
                    <label for="vota-message" style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #333;">VOTA Message</label>
                    <textarea id="vota-message" 
                              placeholder="Enter your message (max 500 characters)" 
                              maxlength="500" 
                              required 
                              rows="5"
                              style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 1rem; resize: vertical; min-height: 100px; transition: border-color 0.3s;"
                              onfocus="this.style.borderColor='#457373';"
                              onblur="this.style.borderColor='#ddd';"
                              oninput="updateCharCount(this)"></textarea>
                    <small style="color: #666; font-size: 0.85rem;"><span id="vota-char-count">0</span>/500 characters</small>
                </div>
                <button type="submit" 
                        style="width: 100%; padding: 14px; background: linear-gradient(135deg, #BF5B04, #457373); color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 1.1rem; cursor: pointer; transition: all 0.3s;"
                        onmouseover="this.style.opacity='0.9';"
                        onmouseout="this.style.opacity='1';">
                    üìß Submit VOTA
                </button>
            </form>
        </div>
    </div>

    <nav class="main-nav">
        <button class="nav-tab active" onclick="showPage('faq')">‚ùì F.A.Q.</button>
        <button class="nav-tab" onclick="showPage('knowmore')">üí° The More You Know</button>
        <button class="nav-tab" onclick="showPage('calendar')">üìÖ DC Calendar Events</button>
        <button class="nav-tab" onclick="showPage('newsletter')">üì¨ Newsletter</button>
    </nav>

    <div class="container">
        <!-- FAQ Page -->
        <div id="faq" class="page active">
            <h2>‚ùì Frequently Asked Questions</h2>
            <div class="faq-container">
                <div class="category-dropdown">
                    <label for="faq-category"><strong>Select Category:</strong></label>
                    <select id="faq-category" onchange="filterFAQ(this.value)">
                        <option value="all">All Categories</option>
                        <option value="working-out-of-area">Working Out Of Area</option>
                        <option value="auditing">Auditing Expectations</option>
                        <option value="benefits">Benefits</option>
                    </select>
                </div>
                <div id="faq-items"></div>
            </div>
        </div>

        <!-- The More You Know Page -->
        <div id="knowmore" class="page">
            <h2>üí° The More You Know</h2>
            <div class="carousel-section">
                <div class="carousel-container">
                    <div class="carousel-header">
                        <span class="carousel-title">‚ú¶ Featured Topics</span>
                        <div class="carousel-controls">
                            <button class="carousel-nav-btn" id="carousel-prev" onclick="carouselPrev()" aria-label="Previous slide">‚Äπ</button>
                            <button class="carousel-nav-btn" id="carousel-next" onclick="carouselNext()" aria-label="Next slide">‚Ä∫</button>
                            <button class="autoplay-toggle playing" id="autoplay-toggle" onclick="toggleAutoplay()" aria-label="Toggle auto-scroll">
                                <span id="autoplay-icon">‚è∏</span>
                                <span id="autoplay-text">Auto</span>
                            </button>
                        </div>
                    </div>
                    <div class="carousel-track-wrapper">
                        <div class="carousel-track" id="carousel">
                            <!-- Slides will be generated here -->
                        </div>
                    </div>
                    <div class="carousel-indicators" id="carousel-indicators">
                        <!-- Dots will be generated here -->
                    </div>
                    <div class="carousel-progress">
                        <div class="carousel-progress-bar" id="carousel-progress"></div>
                    </div>
                </div>
                <div class="carousel-content" id="carousel-content">
                    <!-- Content will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Calendar Events Page -->
        <div id="calendar" class="page">
            <h2>üìÖ DC Calendar Events</h2>
            <div class="calendar-wrapper">
                <div class="calendar">
                    <div class="calendar-header">
                        <button onclick="prevMonth()">‚Üê Prev</button>
                        <h3 id="calendar-month"></h3>
                        <button onclick="nextMonth()">Next ‚Üí</button>
                    </div>
                    <div class="weekdays">
                        <div class="weekday">Sun</div>
                        <div class="weekday">Mon</div>
                        <div class="weekday">Tue</div>
                        <div class="weekday">Wed</div>
                        <div class="weekday">Thu</div>
                        <div class="weekday">Fri</div>
                        <div class="weekday">Sat</div>
                    </div>
                    <div class="days" id="calendar-days"></div>
                </div>
                <div class="events-list">
                    <h3>Events</h3>
                    <div id="events-items"></div>
                </div>
            </div>
        </div>

        <!-- Newsletter Page -->
        <div id="newsletter" class="page">
            <h2>üì¨ Newsletter</h2>
            
            <!-- Newsletter Subscription Section -->
            <div class="newsletter-subscribe" style="background: linear-gradient(135deg, var(--primary-light), var(--primary)); color: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; text-align: center;">
                <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.5rem;">üìß Subscribe to Work-Hub Newsletter</h3>
                <p style="margin-bottom: 1.5rem; opacity: 0.95;">Stay up to date with the latest news, updates, and announcements from Work-Hub.</p>
                <button onclick="handleSubscribeClick()" 
                   class="subscribe-btn" 
                   style="display: inline-block; padding: 14px 32px; background: white; color: var(--primary-dark); text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 1.1rem; transition: all 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer; border: none;">
                    ‚úâÔ∏è Subscribe Now
                </button>
                
                <!-- How to Subscribe Instructions -->
                <div style="margin-top: 1.5rem; text-align: left; background: rgba(255,255,255,0.15); padding: 1.25rem 1.5rem; border-radius: 8px;">
                    <p style="font-weight: 600; margin-bottom: 0.75rem; font-size: 1rem;">üìã How to Subscribe:</p>
                    <ol style="margin: 0; padding-left: 1.5rem; font-size: 0.95rem; line-height: 1.8;">
                        <li><strong>Click Subscribe</strong> ‚Äî Opens your email with a pre-filled message</li>
                        <li><strong>Review the email</strong> ‚Äî Your subscription request is ready to go</li>
                        <li><strong>Hit Send</strong> ‚Äî That's it, you're subscribed!</li>
                    </ol>
                </div>
            </div>
            
            <div class="newsletter-wrapper">
                <div class="newsletter-list">
                    <h3>Previous Newsletters</h3>
                    <div id="newsletter-items"></div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Configuration - Update these with your GitHub repository details
        const GITHUB_REPO = 'x0bi3/Work-Hub'; // Format: username/repo-name
        const GITHUB_BRANCH = 'main'; // Your default branch name

        // Dynamic data (loaded from GitHub)
        let faqData = {};
        let faqCategories = [];
        let carouselSlides = [];

        /**
         * Fetch FAQ data from GitHub
         * Loads from resources/faq/manifest.json and individual question files
         */
        async function fetchFAQFromGitHub() {
            console.log('‚ùì Loading FAQ data...');
            const container = document.getElementById('faq-items');
            container.innerHTML = '<p style="color: var(--text-light);">Loading FAQ...</p>';
            
            // Cache buster to ensure fresh data
            const cacheBuster = `?t=${Date.now()}`;
            
            try {
                // Load manifest
                const manifestUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/resources/faq/manifest.json${cacheBuster}`;
                const manifestResponse = await fetch(manifestUrl, { cache: 'no-store' });
                
                if (!manifestResponse.ok) {
                    throw new Error('FAQ manifest not found');
                }
                
                const manifest = await manifestResponse.json();
                faqCategories = manifest.categories || [];
                
                // Update category dropdown
                const categorySelect = document.getElementById('faq-category');
                if (categorySelect) {
                    categorySelect.innerHTML = '<option value="all">All Categories</option>' +
                        faqCategories.map(c => `<option value="${c.id}">${c.icon} ${c.name}</option>`).join('');
                }
                
                // Load each FAQ item
                faqData = {};
                for (const fileName of manifest.items) {
                    try {
                        const itemUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/resources/faq/${fileName}${cacheBuster}`;
                        const itemResponse = await fetch(itemUrl, { cache: 'no-store' });
                        if (itemResponse.ok) {
                            const item = await itemResponse.json();
                            if (!faqData[item.category]) {
                                faqData[item.category] = [];
                            }
                            faqData[item.category].push({
                                q: item.question,
                                a: item.answer,
                                icon: item.icon || '',
                                order: item.order
                            });
                        }
                    } catch (e) {
                        console.warn(`Failed to load FAQ item: ${fileName}`);
                    }
                }
                
                // Sort items by order within each category
                for (const category in faqData) {
                    faqData[category].sort((a, b) => a.order - b.order);
                }
                
                console.log('‚úÖ Loaded FAQ data:', Object.keys(faqData).length, 'categories');
                
            } catch (error) {
                console.error('‚ùå Failed to load FAQ:', error);
                container.innerHTML = '<p style="color: var(--danger);">Failed to load FAQ. Please try again later.</p>';
            }
        }

        /**
         * Fetch TMYK (The More You Know) data from GitHub
         * Loads from resources/tmyk/manifest.json and individual topic files
         */
        async function fetchTMYKFromGitHub() {
            console.log('üí° Loading TMYK data...');
            
            // Cache buster to ensure fresh data
            const cacheBuster = `?t=${Date.now()}`;
            
            try {
                // Load manifest
                const manifestUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/resources/tmyk/manifest.json${cacheBuster}`;
                const manifestResponse = await fetch(manifestUrl, { cache: 'no-store' });
                
                if (!manifestResponse.ok) {
                    throw new Error('TMYK manifest not found');
                }
                
                const manifest = await manifestResponse.json();
                carouselSlides = [];
                
                // Load each TMYK item
                for (const fileName of manifest.items) {
                    try {
                        const itemUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/resources/tmyk/${fileName}${cacheBuster}`;
                        const itemResponse = await fetch(itemUrl, { cache: 'no-store' });
                        if (itemResponse.ok) {
                            const item = await itemResponse.json();
                            carouselSlides.push({
                                id: item.id,
                                title: item.title,
                                icon: item.icon,
                                preview: item.preview,
                                content: item.content,
                                order: item.order
                            });
                        }
                    } catch (e) {
                        console.warn(`Failed to load TMYK item: ${fileName}`);
                    }
                }
                
                // Sort by order
                carouselSlides.sort((a, b) => a.order - b.order);
                
                console.log('‚úÖ Loaded TMYK data:', carouselSlides.length, 'slides');
                
            } catch (error) {
                console.error('‚ùå Failed to load TMYK:', error);
            }
        }

        // Calendar Events Data (loaded from GitHub)
        let calendarEvents = [];

        /**
         * Fetch calendar events from GitHub repository
         * Loads from events/manifest.json (auto-updated by admin panel)
         */
        async function fetchEventsFromGitHub() {
            console.log('üìÖ Loading events from GitHub...');
            
            // Cache buster to ensure fresh data
            const cacheBuster = `?t=${Date.now()}`;
            
            try {
                const manifestUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/events/manifest.json${cacheBuster}`;
                console.log('üìÑ Loading from events manifest:', manifestUrl);
                const manifestResponse = await fetch(manifestUrl, { cache: 'no-store' });
                
                if (!manifestResponse.ok) {
                    console.log('üìÖ No events manifest found, using empty events list');
                    calendarEvents = [];
                    return;
                }
                
                const manifest = await manifestResponse.json();
                console.log('‚úÖ Loaded events manifest with', manifest.events.length, 'entries');
                
                // Filter to only active events and transform for calendar display
                calendarEvents = manifest.events
                    .filter(e => e.status === 'active')
                    .map(e => {
                        const startDate = new Date(e.startDate);
                        return {
                            id: e.id,
                            date: startDate.getDate(),
                            month: startDate.getMonth(),
                            year: startDate.getFullYear(),
                            title: e.title,
                            description: e.description || '',
                            location: e.location || '',
                            startDate: e.startDate,
                            endDate: e.endDate,
                            eventType: e.eventType || 'single'
                        };
                    });
                
                console.log('‚úÖ Loaded', calendarEvents.length, 'calendar events');
                
            } catch (error) {
                console.error('‚ùå Failed to load events:', error);
                calendarEvents = [];
            }
        }

        // Newsletter Data (will be populated from GitHub)
        let newsletters = [];

        // Initialize
        let currentMonth = new Date();

        /**
         * Fetch newsletters from GitHub repository
         * Loads from newsletters/manifest.json (auto-updated by admin panel)
         * Falls back to GitHub API if manifest not available
         */
        async function fetchNewslettersFromGitHub() {
            try {
                // First, show some feedback to the user
                const container = document.getElementById('newsletter-items');
                container.innerHTML = '<p style="color: var(--text-light);">Loading newsletters...</p>';
                
                console.log('üì∞ Attempting to load newsletters...');
                
                // Cache buster to ensure fresh data
                const cacheBuster = `?t=${Date.now()}`;
                
                // Try to load from the newsletter manifest (primary source)
                try {
                    const manifestUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/newsletters/manifest.json${cacheBuster}`;
                    console.log('üìÑ Loading from newsletter manifest:', manifestUrl);
                    const manifestResponse = await fetch(manifestUrl, { cache: 'no-store' });
                    
                    if (manifestResponse.ok) {
                        const manifest = await manifestResponse.json();
                        console.log('‚úÖ Loaded manifest with', manifest.newsletters.length, 'entries');
                        
                        // Filter to only published newsletters and fetch their content
                        const published = manifest.newsletters.filter(n => n.status === 'published');
                        const parsed = [];
                        
                        for (const entry of published) {
                            try {
                                const contentUrl = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/${entry.path}${cacheBuster}`;
                                const contentResponse = await fetch(contentUrl, { cache: 'no-store' });
                                if (contentResponse.ok) {
                                    const htmlContent = await contentResponse.text();
                                    const newsletter = parseNewsletter(htmlContent);
                                    // Use manifest metadata as fallback
                                    newsletter.title = newsletter.title || entry.title;
                                    newsletter.publishDate = newsletter.publishDate || entry.publishDate;
                                    newsletter.tags = newsletter.tags.length ? newsletter.tags : (entry.tags || []);
                                    parsed.push(newsletter);
                                }
                            } catch (e) {
                                console.warn(`Failed to fetch ${entry.title}:`, e);
                            }
                        }
                        
                        parsed.sort((a, b) => new Date(b.publishDate) - new Date(a.publishDate));
                        newsletters = parsed;
                        console.log(`‚úÖ Loaded ${newsletters.length} published newsletters from manifest`);
                        return; // Success - exit early
                    }
                } catch (e) {
                    console.log('üìã Manifest not available, trying GitHub API...', e);
                }
                
                const apiUrl = `https://api.github.com/repos/${GITHUB_REPO}/contents/newsletters?ref=${GITHUB_BRANCH}`;
                console.log('üì∞ Fetching newsletters from GitHub API:', apiUrl);
                
                // Recursively fetch all newsletter files
                const fetchDir = async (path, depth = 0) => {
                    console.log(`  ${'  '.repeat(depth)}Scanning: ${path}`);
                    const response = await fetch(path, { cache: 'no-store' });
                    
                    if (!response.ok) {
                        console.warn(`  ${'  '.repeat(depth)}‚ùå API returned ${response.status}`);
                        return [];
                    }
                    
                    const contents = await response.json();
                    console.log(`  ${'  '.repeat(depth)}Found ${contents.length} items`);
                    
                    let files = [];
                    
                    for (const item of contents) {
                        if (item.type === 'dir') {
                            console.log(`  ${'  '.repeat(depth)}üìÅ Directory: ${item.name}`);
                            // Recursively fetch subdirectories
                            const subFiles = await fetchDir(item.url, depth + 1);
                            files = files.concat(subFiles);
                        } else if (item.name.endsWith('.html')) {
                            console.log(`  ${'  '.repeat(depth)}üìÑ Newsletter: ${item.name}`);
                            files.push(item);
                        }
                    }
                    return files;
                };
                
                const files = await fetchDir(apiUrl);
                console.log(`‚úÖ Found ${files.length} newsletter files total`);
                
                // Parse each newsletter file
                const parsed = [];
                for (const file of files) {
                    try {
                        console.log(`  Parsing: ${file.name}`);
                        // Add cache buster to download URL
                        const downloadUrl = file.download_url + (file.download_url.includes('?') ? '&' : '?') + `t=${Date.now()}`;
                        const contentResponse = await fetch(downloadUrl, { cache: 'no-store' });
                        if (!contentResponse.ok) {
                            console.warn(`  ‚ùå Failed to fetch ${file.name}`);
                            continue;
                        }
                        
                        const htmlContent = await contentResponse.text();
                        const newsletter = parseNewsletter(htmlContent);
                        console.log(`  Title: ${newsletter.title}, Status: ${newsletter.status}`);
                        
                        // Only show published newsletters
                        if (newsletter.status === 'published') {
                            parsed.push(newsletter);
                        } else {
                            console.log(`  (Skipped - status is '${newsletter.status}', not 'published')`);
                        }
                    } catch (e) {
                        console.error(`  Error parsing ${file.name}:`, e);
                    }
                }
                
                // Sort by publish date (newest first)
                parsed.sort((a, b) => new Date(b.publishDate) - new Date(a.publishDate));
                newsletters = parsed;
                
                console.log(`‚úÖ Loaded ${newsletters.length} published newsletters:`, newsletters);
            } catch (error) {
                console.error('‚ùå Error fetching newsletters from GitHub:', error);
                console.error('Full error details:', JSON.stringify(error, null, 2));
                // Show error message to user
                const container = document.getElementById('newsletter-items');
                container.innerHTML = `<p style="color: var(--danger);">‚ö†Ô∏è Error loading newsletters: ${error.message}</p>
                    <p style="color: var(--text-light); font-size: 0.9rem;">Please check the browser console for details.</p>`;
                // Fall back to empty array if fetch fails
                newsletters = [];
            }
        }

        /**
         * Parse newsletter HTML to extract metadata and preview
         */
        function parseNewsletter(htmlContent) {
            // Extract metadata from HTML comment block
            const metaMatch = htmlContent.match(/<!--\s*({.*?})\s*-->/s);
            let metadata = {
                title: 'Untitled Newsletter',
                publishDate: new Date().toISOString().split('T')[0],
                status: 'draft',
                tags: []
            };

            if (metaMatch) {
                try {
                    metadata = JSON.parse(metaMatch[1]);
                } catch (e) {
                    console.warn('Failed to parse newsletter metadata', e);
                }
            }

            // Extract body and create preview (first 150 chars)
            const bodyStart = metaMatch ? metaMatch[0].length : 0;
            const body = htmlContent.substring(bodyStart).trim();
            const plainText = body.replace(/<[^>]*>/g, '').trim();
            const preview = plainText.substring(0, 150) + (plainText.length > 150 ? '...' : '');

            // Format date
            const date = new Date(metadata.publishDate);
            const formattedDate = date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });

            return {
                title: metadata.title,
                date: formattedDate,
                preview: preview,
                content: body,
                publishDate: metadata.publishDate,
                status: metadata.status,
                tags: metadata.tags || []
            };
        }

        async function init() {
            // Fetch all dynamic content from GitHub
            await Promise.all([
                fetchFAQFromGitHub(),
                fetchTMYKFromGitHub(),
                fetchNewslettersFromGitHub(),
                fetchEventsFromGitHub()
            ]);
            
            // Render all sections
            renderFAQ('all');
            renderCarousel();
            if (carouselSlides.length > 0) {
                loadCarouselContent(carouselSlides[0].id);
            }
            renderCalendar();
            renderEvents();
            renderNewsletters();
            
            // Add click-outside-to-deselect for calendar
            document.addEventListener('click', function(e) {
                // Only handle clicks when on calendar page and a day is selected
                if (selectedDay === null) return;
                
                // Check if click was on a calendar day
                const clickedDay = e.target.closest('.day:not(.other-month)');
                if (clickedDay) return; // Let selectDate handle it
                
                // Check if click was on an event item
                const clickedEvent = e.target.closest('.event-item');
                if (clickedEvent) return; // Let event click handler handle it
                
                // Check if click was on prev/next month buttons
                const clickedButton = e.target.closest('.calendar-header button');
                if (clickedButton) return;
                
                // Click was outside - clear selection
                clearDateSelection();
            });
        }

        // Navigation
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageName).classList.add('active');
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Handle carousel autoplay based on page visibility
            if (pageName === 'knowmore' && isAutoplayEnabled) {
                startAutoplay();
            } else {
                stopAutoplay();
            }
        }

        // FAQ Functions
        function renderFAQ(category) {
            const container = document.getElementById('faq-items');
            let items = [];
            
            if (category === 'all') {
                Object.values(faqData).forEach(cat => items.push(...cat));
            } else {
                items = faqData[category] || [];
            }

            container.innerHTML = items.map((item, idx) => `
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFAQ(this)">
                        <span>${item.icon ? item.icon + ' ' : ''}${item.q}</span>
                        <span class="faq-toggle">‚ñº</span>
                    </div>
                    <div class="faq-answer rich-content">
                        ${item.a}
                    </div>
                </div>
            `).join('');
        }

        function filterFAQ(category) {
            renderFAQ(category);
        }

        function toggleFAQ(element) {
            const question = element;
            const answer = element.nextElementSibling;
            const toggle = element.querySelector('.faq-toggle');
            
            answer.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        // Carousel State & Configuration
        let currentSlideIndex = 0;
        let carouselAutoplayInterval = null;
        let carouselProgressInterval = null;
        let isAutoplayEnabled = true;
        const AUTOPLAY_DURATION = 6000; // 6 seconds per slide
        const PROGRESS_UPDATE_INTERVAL = 50; // Update progress bar every 50ms
        
        // Progress tracking for pause/resume
        let carouselProgressValue = 0;
        let carouselElapsedTime = 0;

        // Carousel Functions
        function renderCarousel() {
            const carousel = document.getElementById('carousel');
            const indicators = document.getElementById('carousel-indicators');
            
            if (carouselSlides.length === 0) {
                carousel.innerHTML = '<div class="carousel-slide"><p style="color: var(--text-light); text-align: center;">Loading content...</p></div>';
                indicators.innerHTML = '';
                return;
            }
            
            // Render slides
            carousel.innerHTML = carouselSlides.map((slide, index) => `
                <div class="carousel-slide" data-slide-index="${index}">
                    <div>
                        <div class="carousel-slide-icon">${slide.icon || 'üí°'}</div>
                        <h4>${slide.title}</h4>
                        <p>${slide.preview}</p>
                    </div>
                    <button class="carousel-btn" onclick="loadCarouselContent('${slide.id}')">Learn More</button>
                </div>
            `).join('');
            
            // Render indicator dots
            indicators.innerHTML = carouselSlides.map((_, index) => `
                <button class="carousel-dot ${index === 0 ? 'active' : ''}" 
                        data-index="${index}" 
                        onclick="goToSlide(${index})"
                        aria-label="Go to slide ${index + 1}"></button>
            `).join('');
            
            // Set initial slide position
            updateCarouselPosition();
            
            // Start autoplay
            if (isAutoplayEnabled) {
                startAutoplay();
            }
            
            // Add hover pause behavior
            const container = document.querySelector('.carousel-container');
            container.addEventListener('mouseenter', pauseAutoplay);
            container.addEventListener('mouseleave', resumeAutoplay);
            
            // Initialize touch swipe (needs DOM elements)
            initCarouselTouchSwipe();
        }

        function updateCarouselPosition() {
            const carousel = document.getElementById('carousel');
            const translateX = -currentSlideIndex * 100;
            carousel.style.transform = `translateX(${translateX}%)`;
            
            // Update active dot
            document.querySelectorAll('.carousel-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlideIndex);
            });
            
            // Update nav button states
            updateNavButtonStates();
        }

        function updateNavButtonStates() {
            const prevBtn = document.getElementById('carousel-prev');
            const nextBtn = document.getElementById('carousel-next');
            
            // In auto-scroll mode, we loop, so buttons are always enabled
            // But we can optionally disable at boundaries for manual nav
            if (prevBtn) prevBtn.disabled = false;
            if (nextBtn) nextBtn.disabled = false;
        }

        function goToSlide(index) {
            if (index < 0) {
                index = carouselSlides.length - 1;
            } else if (index >= carouselSlides.length) {
                index = 0;
            }
            
            currentSlideIndex = index;
            updateCarouselPosition();
            
            // Reset progress for new slide
            carouselProgressValue = 0;
            carouselElapsedTime = 0;
            const progressBar = document.getElementById('carousel-progress');
            if (progressBar) {
                progressBar.style.width = '0%';
            }
        }

        function carouselNext() {
            goToSlide(currentSlideIndex + 1);
        }

        function carouselPrev() {
            goToSlide(currentSlideIndex - 1);
        }

        function startAutoplay(resumeFromPause = false) {
            if (!isAutoplayEnabled || carouselSlides.length <= 1) return;
            
            stopAutoplay();
            
            const progressBar = document.getElementById('carousel-progress');
            
            // If not resuming, reset progress
            if (!resumeFromPause) {
                carouselProgressValue = 0;
                carouselElapsedTime = 0;
            }
            
            // Calculate remaining time for this slide
            const remainingTime = AUTOPLAY_DURATION - carouselElapsedTime;
            
            // Progress bar animation - continues from current progress
            carouselProgressInterval = setInterval(() => {
                carouselElapsedTime += PROGRESS_UPDATE_INTERVAL;
                carouselProgressValue = (carouselElapsedTime / AUTOPLAY_DURATION) * 100;
                if (progressBar) {
                    progressBar.style.width = `${Math.min(carouselProgressValue, 100)}%`;
                }
                
                // Check if we've reached the end of this slide's duration
                if (carouselElapsedTime >= AUTOPLAY_DURATION) {
                    carouselNext();
                    // goToSlide resets the progress, and we continue
                }
            }, PROGRESS_UPDATE_INTERVAL);
        }

        function stopAutoplay() {
            if (carouselAutoplayInterval) {
                clearInterval(carouselAutoplayInterval);
                carouselAutoplayInterval = null;
            }
            if (carouselProgressInterval) {
                clearInterval(carouselProgressInterval);
                carouselProgressInterval = null;
            }
        }

        function pauseAutoplay() {
            if (isAutoplayEnabled) {
                // Stop intervals but preserve progress values
                stopAutoplay();
                const progressBar = document.getElementById('carousel-progress');
                if (progressBar) {
                    progressBar.classList.add('paused');
                }
            }
        }

        function resumeAutoplay() {
            if (isAutoplayEnabled) {
                const progressBar = document.getElementById('carousel-progress');
                if (progressBar) {
                    progressBar.classList.remove('paused');
                }
                // Resume from where we left off
                startAutoplay(true);
            }
        }

        function toggleAutoplay() {
            isAutoplayEnabled = !isAutoplayEnabled;
            
            const toggleBtn = document.getElementById('autoplay-toggle');
            const icon = document.getElementById('autoplay-icon');
            const text = document.getElementById('autoplay-text');
            
            if (isAutoplayEnabled) {
                toggleBtn.classList.add('playing');
                icon.textContent = '‚è∏';
                text.textContent = 'Auto';
                // Reset progress and start fresh
                carouselProgressValue = 0;
                carouselElapsedTime = 0;
                startAutoplay(false);
            } else {
                toggleBtn.classList.remove('playing');
                icon.textContent = '‚ñ∂';
                text.textContent = 'Play';
                stopAutoplay();
                // Reset progress bar
                carouselProgressValue = 0;
                carouselElapsedTime = 0;
                const progressBar = document.getElementById('carousel-progress');
                if (progressBar) {
                    progressBar.style.width = '0%';
                }
            }
        }

        function loadCarouselContent(slideId) {
            const slide = carouselSlides.find(s => s.id === slideId);
            const content = document.getElementById('carousel-content');
            
            if (!slide) {
                content.innerHTML = '<p>Select a topic to learn more.</p>';
                return;
            }
            
            content.innerHTML = `
                <h4>${slide.icon || 'üí°'} ${slide.title}</h4>
                <div class="carousel-content-body rich-content">${slide.content}</div>
            `;
            
            // Smooth scroll to content on mobile
            if (window.innerWidth < 768) {
                content.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Keyboard Navigation for Carousel
        function initCarouselKeyboardNav() {
            document.addEventListener('keydown', (e) => {
                // Only respond when on the TMYK page
                const tmykPage = document.getElementById('knowmore');
                if (!tmykPage || !tmykPage.classList.contains('active')) return;
                
                if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    carouselPrev();
                } else if (e.key === 'ArrowRight') {
                    e.preventDefault();
                    carouselNext();
                } else if (e.key === ' ' && e.target.tagName !== 'BUTTON' && e.target.tagName !== 'INPUT') {
                    e.preventDefault();
                    toggleAutoplay();
                }
            });
        }

        // Touch Swipe Support for Carousel
        function initCarouselTouchSwipe() {
            const carouselWrapper = document.querySelector('.carousel-track-wrapper');
            if (!carouselWrapper) return;
            
            let touchStartX = 0;
            let touchEndX = 0;
            const minSwipeDistance = 50;
            
            carouselWrapper.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });
            
            carouselWrapper.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, { passive: true });
            
            function handleSwipe() {
                const swipeDistance = touchEndX - touchStartX;
                
                if (Math.abs(swipeDistance) < minSwipeDistance) return;
                
                if (swipeDistance > 0) {
                    carouselPrev(); // Swipe right = go to previous
                } else {
                    carouselNext(); // Swipe left = go to next
                }
            }
        }

        // Initialize carousel keyboard navigation on page load
        document.addEventListener('DOMContentLoaded', () => {
            initCarouselKeyboardNav();
        });

        // Calendar Functions
        function renderCalendar() {
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            
            document.getElementById('calendar-month').textContent = `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const prevLastDay = new Date(year, month, 0);
            
            let html = '';
            
            // Previous month days
            for (let i = firstDay.getDay(); i > 0; i--) {
                html += `<div class="day other-month">${prevLastDay.getDate() - i + 1}</div>`;
            }
            
            // Current month days
            for (let i = 1; i <= lastDay.getDate(); i++) {
                const hasEvent = calendarEvents.some(e => e.date === i && e.month === month && e.year === year);
                html += `<div class="day ${hasEvent ? 'has-event' : ''}" onclick="event.stopPropagation(); selectDate(${i})">${i}</div>`;
            }
            
            // Next month days
            for (let i = 1; i <= (35 - lastDay.getDate() - firstDay.getDay() + 1); i++) {
                html += `<div class="day other-month">${i}</div>`;
            }
            
            document.getElementById('calendar-days').innerHTML = html;
        }

        // Track currently selected day
        let selectedDay = null;

        function clearDateSelection() {
            selectedDay = null;
            document.querySelectorAll('.day').forEach(d => d.classList.remove('selected'));
            renderEvents();
        }

        function prevMonth() {
            currentMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1);
            clearDateSelection();
            renderCalendar();
        }

        function nextMonth() {
            currentMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1);
            clearDateSelection();
            renderCalendar();
        }

        function selectDate(day) {
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            const events = calendarEvents.filter(e => e.date === day && e.month === month && e.year === year);
            const list = document.getElementById('events-items');
            
            // Update selected day tracking
            selectedDay = day;
            
            // Update visual selection on calendar
            document.querySelectorAll('.day').forEach(d => d.classList.remove('selected'));
            const dayElements = document.querySelectorAll('.day:not(.other-month)');
            dayElements.forEach(d => {
                if (parseInt(d.textContent) === day) {
                    d.classList.add('selected');
                }
            });
            
            // Show events for selected day or "no events" message
            const dateHeader = `<p style="color: var(--text-light); padding: 0.5rem 0; font-size: 0.9rem; border-bottom: 1px solid var(--border); margin-bottom: 1rem;">
                Events for ${new Date(year, month, day).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
            </p>`;
            
            if (events.length > 0) {
                list.innerHTML = dateHeader + events.map((e, idx) => `
                    <div class="event-item active">
                        <h4>${e.title}</h4>
                        <p>üìÖ ${new Date(year, month, day).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</p>
                        ${e.location ? `<p>üìç ${e.location}</p>` : ''}
                        <p>${e.description}</p>
                    </div>
                `).join('');
            } else {
                list.innerHTML = dateHeader + `<p style="color: var(--text-light); padding: 1rem; text-align: center;">No events scheduled for this day</p>`;
            }
        }

        function renderEvents() {
            const list = document.getElementById('events-items');
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            
            // Filter to show events for the currently viewed month
            const monthEvents = calendarEvents
                .filter(e => e.month === month && e.year === year)
                .sort((a, b) => a.date - b.date);
            
            if (monthEvents.length === 0) {
                list.innerHTML = '<p style="color: var(--text-light); padding: 1rem;">No events this month</p>';
                return;
            }
            
            list.innerHTML = monthEvents.map(e => {
                const eventDate = new Date(e.year, e.month, e.date);
                return `
                    <div class="event-item" onclick="selectDateFromEvent(${e.date}, ${e.month}, ${e.year}); event.stopPropagation();">
                        <h4>${e.title}</h4>
                        <p>üìÖ ${eventDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</p>
                        ${e.location ? `<p>üìç ${e.location}</p>` : ''}
                        <p>${e.description}</p>
                    </div>
                `;
            }).join('');
        }

        function selectDateFromEvent(day, month, year) {
            document.querySelectorAll('.event-item').forEach(item => item.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // Navigate to the correct month/year if needed
            if (month !== undefined && year !== undefined) {
                currentMonth = new Date(year, month, 1);
                renderCalendar();
            }
            
            selectDate(day);
        }

        // Newsletter Functions
        
        /**
         * Handle newsletter subscribe button click
         * Uses mailto: for mobile devices, Outlook Web App for desktop
         */
        function handleSubscribeClick() {
            const recipient = 'ryan.baldwin@walmart.com';
            const subject = 'Subscribe to Work-Hub Newsletter';
            const body = 'Add me to the list!';
            
            // Detect mobile device
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) 
                || (navigator.maxTouchPoints > 0 && window.innerWidth < 1024);
            
            if (isMobile) {
                // Use mailto: for mobile - works with native mail apps
                const mailtoUrl = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.location.href = mailtoUrl;
            } else {
                // Use Outlook Web App deeplink for desktop
                const owaUrl = `https://outlook.wal-mart.com/mail/deeplink/compose?to=${encodeURIComponent(recipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.open(owaUrl, '_blank', 'noopener,noreferrer');
            }
        }
        
        function renderNewsletters() {
            const container = document.getElementById('newsletter-items');
            
            if (newsletters.length === 0) {
                container.innerHTML = '<p style="color: var(--text-light);">No newsletters available yet.</p>';
                return;
            }
            
            container.innerHTML = newsletters.map((letter, idx) => `
                <div class="newsletter-item">
                    <h4>${letter.title}</h4>
                    <div class="date">${letter.date}</div>
                    <p style="margin-top: 0.5rem;">${letter.preview}</p>
                    <button class="view-newsletter-btn" onclick="viewNewsletter(${idx})" style="margin-top: 1rem; padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 4px; cursor: pointer;">View Newsletter</button>
                </div>
            `).join('');
        }
        
        function viewNewsletter(index) {
            const letter = newsletters[index];
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; padding: 1rem;';
            modal.innerHTML = `
                <div style="background: white; border-radius: 8px; padding: 2rem; max-width: 800px; max-height: 80vh; overflow-y: auto; position: relative;">
                    <button onclick="this.closest('div').parentElement.remove()" style="position: absolute; top: 1rem; right: 1rem; border: none; background: none; font-size: 1.5rem; cursor: pointer;">√ó</button>
                    <h2>${letter.title}</h2>
                    <div style="color: var(--text-light); margin-bottom: 1.5rem;">${letter.date}</div>
                    <div style="border-top: 1px solid var(--border); padding-top: 1.5rem;">
                        ${letter.content}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // VOTA Modal Functions
        
        /**
         * Open the VOTA submission modal
         */
        function openVotaModal() {
            const modal = document.getElementById('vota-modal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden'; // Prevent scrolling behind modal
            
            // Reset form
            document.getElementById('vota-form').reset();
            document.getElementById('vota-char-count').textContent = '0';
            
            // Focus on the first input
            setTimeout(() => document.getElementById('vota-associate-id').focus(), 100);
        }
        
        /**
         * Close the VOTA submission modal
         */
        function closeVotaModal() {
            const modal = document.getElementById('vota-modal');
            modal.style.display = 'none';
            document.body.style.overflow = ''; // Restore scrolling
        }
        
        /**
         * Update character count for VOTA message
         */
        function updateCharCount(textarea) {
            const count = textarea.value.length;
            const counter = document.getElementById('vota-char-count');
            counter.textContent = count;
            
            // Change color when approaching limit
            if (count >= 450) {
                counter.style.color = '#BF5B04';
            } else {
                counter.style.color = '#666';
            }
        }
        
        /**
         * Validate Associate ID (1-5 digits only)
         */
        function validateAssociateId(id) {
            const pattern = /^[0-9]{1,5}$/;
            return pattern.test(id);
        }
        
        /**
         * Submit VOTA form and trigger mailto
         */
        function submitVota(event) {
            event.preventDefault();
            
            const associateId = document.getElementById('vota-associate-id').value.trim();
            const message = document.getElementById('vota-message').value.trim();
            
            // Validate Associate ID
            if (!validateAssociateId(associateId)) {
                alert('Please enter a valid Associate ID (1-5 digits only)');
                document.getElementById('vota-associate-id').focus();
                return;
            }
            
            // Validate message length
            if (message.length === 0) {
                alert('Please enter a VOTA message');
                document.getElementById('vota-message').focus();
                return;
            }
            
            if (message.length > 500) {
                alert('VOTA message must be 500 characters or less');
                document.getElementById('vota-message').focus();
                return;
            }
            
            // Build email content
            const recipient = 'ryan.baldwin@walmart.com';
            const subject = 'VOTA Submission';
            const body = `Associate ID: ${associateId}\n\nVOTA Message:\n${message}\n\n-----`;
            
            // Detect mobile device
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) 
                || (navigator.maxTouchPoints > 0 && window.innerWidth < 1024);
            
            if (isMobile) {
                // Use mailto: for mobile - works with native mail apps
                const mailtoUrl = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.location.href = mailtoUrl;
            } else {
                // Use Outlook Web App deeplink for desktop
                const owaUrl = `https://outlook.wal-mart.com/mail/deeplink/compose?to=${encodeURIComponent(recipient)}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                window.open(owaUrl, '_blank', 'noopener,noreferrer');
            }
            
            // Close modal after submission
            closeVotaModal();
        }
        
        // Close modal when clicking outside
        document.getElementById('vota-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeVotaModal();
            }
        });
        
        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('vota-modal');
                if (modal.style.display === 'flex') {
                    closeVotaModal();
                }
            }
        });

        // Initialize on load
        init();
    </script>
</body>
</html>
